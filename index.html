<!DOCTYPE html>
<html>
  <head>
    <title>HTML5</title>
    <meta charset="utf-8" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link rel="stylesheet"  href="css/style.css">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script>
      $(function() {
        $( "#slider-range" ).slider({
          range: true,
          min: -600,
          max: 999,
          values: [ -400, -200 ],
          slide: function( event, ui ) {
            $( "#range" ).val( "From " + ui.values[0] + " To " + ui.values[1] );
            $('path.coastlines').a
          }
        });
        $( "#range" ).val("From " + $("#slider-range").slider("values", 0) +
         " To " + $("#slider-range").slider( "values", 1 ));
      });
  </script>
  </head>
  <body>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="//d3js.org/d3.geo.projection.v0.min.js"></script>
    <script src="//d3js.org/topojson.v1.min.js"></script>
    <div id="container">
      <header>
        <h1>Arctic Plate Movement and Coastlines Since Pangaea</h1>
        <h3 id='slider-values'></h3>
      </header>
    </div>
    <div id="hello-world"></div>
    <div id="slider-container">
      <p>
        <label for="year-range">Years</label>
        <input type="text" id="range" readonly style="border:0; color:#f6931f; font-weight:bold;">
      </p>
  
      <div id="slider-range"></div>
    </div>

    <script>
      var width = 1000, height = 800;
      var projection = d3.geo.orthographic()
        .scale(500)
        .translate([width/2, height/2])
        .clipAngle(90);
      
      var path = d3.geo.path()
        .projection(projection);
      
      var lamd = d3.scale.linear()
        .domain([0, width])
        .range([-180, 180]);
      
      var phi = d3.scale.linear()
        .domain([0, height])
        .range([90,-90])

      var svg = d3.select("#hello-world").append("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("id", 'globe-container');

      var mapmove = false;

      document.getElementById('globe-container').addEventListener("mousedown", mdown, false);

      function mdown() { 
        console.log('clicked') 
        mapmove = !mapmove;
        svg.on("mousemove", function() {
          if (mapmove == true) {
            var p = d3.mouse(this);
            projection.rotate( [lamd(p[0]) , phi(p[1]) ]);
            svg.selectAll("path").attr("d", path);
          }
        });
      }

      d3.json("goodplates.json", function(error, plates) {
        if (error) return console.error(error);
        
        svg.selectAll(".coastlines")
            .data(topojson.feature(plates, plates.objects.coastlines).features)
          .enter().append("path")
            .attr("class", function(d) { return "coastlines " + d.properties.NAME + ' from' + d.properties.FROMAGE + ' to' + d.properties.TOAGE; })
            .attr("d", path)
            .attr("from", function(d) {return d.properties.FROMAGE })
            .attr("to", function(d) {return d.properties.TOAGE });

        $('#slider-range').on('slide', function(e, ui) {
          svg.selectAll('.coastlines')
              .data(topojson.feature(plates, plates.objects.coastlines).features, function(d) {
                if (d.properties.FROMAGE * -1 < ui.values[0]) {
                  console.log(d);
                };
              });

        });
      });

    </script>
  </body>
</html>